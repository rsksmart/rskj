# acc1 = "0xa0663f719962ec10bb57865532bef522059dfd96"
account_new acc1 20000000

# Deploy Contract
transaction_build tx01
    sender acc1
    nonce 0
    receiver 00
    data 608060405234801561001057600080fd5b5060008060146101000a81548160ff0219169083151502179055506103068061003a6000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80633fd1b8b51461003b5780636146195414610057575b600080fd5b61005560048036038101906100509190610255565b610061565b005b61005f6100bf565b005b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600060146101000a81548160ff02191690831515021790555050565b600073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff16319050600060149054906101000a900460ff161561023d5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663614619546040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561022457600080fd5b505af1158015610238573d6000803e3d6000fd5b505050505b50565b60008135905061024f816102b9565b92915050565b60006020828403121561026b5761026a6102b4565b5b600061027984828501610240565b91505092915050565b600061028d82610294565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600080fd5b6102c281610282565b81146102cd57600080fd5b5056fea2646970667358221220f0cb6073cf248075bfb43257fdb3eb5e091f1ee8a369921a8cc6750309000f9764736f6c63430008070033
    gas 6000000
    build

# Deploy Contract
# addr: 0x56aa252dd82173789984fa164ee26ce2da9336ff
transaction_build tx02
    sender acc1
    nonce 1
    receiver 00
    data 608060405234801561001057600080fd5b5060008060146101000a81548160ff0219169083151502179055506103068061003a6000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80633fd1b8b51461003b5780636146195414610057575b600080fd5b61005560048036038101906100509190610255565b610061565b005b61005f6100bf565b005b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600060146101000a81548160ff02191690831515021790555050565b600073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff1631905073fce93641243d1efb6131277ccd1c0a60460d561073ffffffffffffffffffffffffffffffffffffffff16319050600060149054906101000a900460ff161561023d5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663614619546040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561022457600080fd5b505af1158015610238573d6000803e3d6000fd5b505050505b50565b60008135905061024f816102b9565b92915050565b60006020828403121561026b5761026a6102b4565b5b600061027984828501610240565b91505092915050565b600061028d82610294565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600080fd5b6102c281610282565b81146102cd57600080fd5b5056fea2646970667358221220f0cb6073cf248075bfb43257fdb3eb5e091f1ee8a369921a8cc6750309000f9764736f6c63430008070033
    gas 6000000
    build

# Call .setAnotherContract
transaction_build tx03
    sender acc1
    nonce 2
    contract tx01
    data 3fd1b8b500000000000000000000000056aa252dd82173789984fa164ee26ce2da9336ff # setAnotherContract(address)
    gas 6000000
    build

block_build b01
    parent g00
    transactions tx01 tx02 tx03
    gasLimit 6800000
    build

block_connect b01
assert_best b01
assert_tx_success tx01
assert_tx_success tx02
assert_tx_success tx03

# Call .execute
transaction_build tx04
    sender acc1
    nonce 3
    contract tx01
    data 61461954 # execute()
    gas 6000000
    build

block_build b02
    parent b01
    transactions tx04
    gasLimit 6800000
    build

block_connect b02
assert_best b02
assert_tx_success tx04

# Contract used
comment
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.7;

contract MismatchesNested {

    MismatchesNested anotherContract;
    bool initialized;


    constructor() {
        initialized = false;
    }

    function setAnotherContract(address addr) public {
        anotherContract = MismatchesNested(addr);
        initialized = true;
    }

    function execute() public {
        uint b = address(0xFce93641243D1EFB6131277cCD1C0a60460D5610).balance;
        b = address(0xFce93641243D1EFB6131277cCD1C0a60460D5610).balance;
        b = address(0xFce93641243D1EFB6131277cCD1C0a60460D5610).balance;
        b = address(0xFce93641243D1EFB6131277cCD1C0a60460D5610).balance;
        b = address(0xFce93641243D1EFB6131277cCD1C0a60460D5610).balance;
        if(initialized) {
            anotherContract.execute();
        }
    }
}
end
