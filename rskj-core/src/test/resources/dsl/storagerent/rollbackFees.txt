# acc1 = "0xa0663f719962ec10bb57865532bef522059dfd96"
account_new acc1 20000000

# Deploy RollbackFees
transaction_build tx01
    sender acc1
    nonce 0
    receiver 00
    data 608060405234801561001057600080fd5b506007600081905550610193806100286000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c80633fa4f2451461003b5780636146195414610059575b600080fd5b610043610063565b60405161005091906100fe565b60405180910390f35b610061610069565b005b60005481565b60086000819055506040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016100a3906100de565b60405180910390fd5b60006100b9602083610119565b91506100c482610134565b602082019050919050565b6100d88161012a565b82525050565b600060208201905081810360008301526100f7816100ac565b9050919050565b600060208201905061011360008301846100cf565b92915050565b600082825260208201905092915050565b6000819050919050565b7f726576657274696e6720746f20636865636b20726f6c6c6261636b206665657360008201525056fea26469706673582212206c092884783420caacdf57fe79ea8d5aa7d07aebf01eb123dc68ebbd9e0f802c64736f6c63430008070033
    gas 6000000
    build

block_build b01
    parent g00
    transactions tx01
    gasLimit 6800000
    build

block_connect b01
assert_best b01
assert_tx_success tx01

# Call RollbackFees.execute
transaction_build tx02
    sender acc1
    nonce 1
    contract tx01
    data 61461954 # execute()
    gas 6000000
    build

block_build b02
    parent b01
    transactions tx02
    gasLimit 6800000
    build

block_connect b02
assert_best b02

# Contract used
comment
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.2;

contract RollbackFees {
    uint public value;

    constructor() {
        value = 7;
    }

    function execute() public {
        value; // read key
        value = 8; // write key
        revert("reverting to check rollback fees");
    }
}
end
