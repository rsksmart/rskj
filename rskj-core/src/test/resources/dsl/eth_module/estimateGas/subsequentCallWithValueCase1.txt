comment
compiled using solidity: "0.7.3"

pragma solidity >=0.6.0 <0.9.0;

contract SubsequentCallWithValue {
    address payable nextAddress;
    uint256 valueToSend;

    event NestedCallWithValue();
    event NestedCallWithoutValue();

    fallback () external payable { }

    function callNextAddress() public payable {
        if (nextAddress == address(0)) {
            return;
        }
        
        if (valueToSend > 0) {
            SubsequentCallWithValue(nextAddress).callNextAddress{value: valueToSend}();
            emit NestedCallWithValue();
        } else {
            SubsequentCallWithValue(nextAddress).callNextAddress();
            emit NestedCallWithoutValue();
        }
    }

    function setNextAddress(address payable n) public {
        nextAddress = n;
    }

    function setValueToSend(uint256 value) public {
        valueToSend = value;
    }
}
end

# Case: [USER] -call-without-value-> [CONTRUCT #1] -call-without-value-> [CONTRUCT #2] -call-with-value-> [CONTRUCT #3]

account_new acc1 20000000

# Deploy three instances of SubsequentCallWithValue

transaction_build tx01
    sender acc1
    nonce 0
    receiverAddress 00
    value 0
    data 608060405234801561001057600080fd5b5061031d806100206000396000f3fe6080604052600436106100385760003560e01c806318d3af631461003b5780636efb15df14610045578063ba2647351461008057610039565b5b005b6100436100d1565b005b34801561005157600080fd5b5061007e6004803603602081101561006857600080fd5b810190808035906020019092919050505061029a565b005b34801561008c57600080fd5b506100cf600480360360208110156100a357600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506102a4565b005b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561012b57610298565b600060015411156101ea5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166318d3af636001546040518263ffffffff1660e01b81526004016000604051808303818588803b1580156101a057600080fd5b505af11580156101b4573d6000803e3d6000fd5b50505050507fd99f0cfde566379669cb08fdc25d80461af2e181833081dd90ca21eaabfc1f9560405160405180910390a1610297565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166318d3af636040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561025257600080fd5b505af1158015610266573d6000803e3d6000fd5b505050507fc912088d570658c8656f32ff15e09d77c5d9eb8c4304e077777143ba6225dc8860405160405180910390a15b5b565b8060018190555050565b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505056fea26469706673582212209458b89f68ed66dc26086396962dad91224bfad1e1711e6151d84b91dfe798c564736f6c63430007030033
    gas 1000000
    build

transaction_build tx02
    sender acc1
    nonce 1
    receiverAddress 00
    value 0
    data 608060405234801561001057600080fd5b5061031d806100206000396000f3fe6080604052600436106100385760003560e01c806318d3af631461003b5780636efb15df14610045578063ba2647351461008057610039565b5b005b6100436100d1565b005b34801561005157600080fd5b5061007e6004803603602081101561006857600080fd5b810190808035906020019092919050505061029a565b005b34801561008c57600080fd5b506100cf600480360360208110156100a357600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506102a4565b005b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561012b57610298565b600060015411156101ea5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166318d3af636001546040518263ffffffff1660e01b81526004016000604051808303818588803b1580156101a057600080fd5b505af11580156101b4573d6000803e3d6000fd5b50505050507fd99f0cfde566379669cb08fdc25d80461af2e181833081dd90ca21eaabfc1f9560405160405180910390a1610297565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166318d3af636040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561025257600080fd5b505af1158015610266573d6000803e3d6000fd5b505050507fc912088d570658c8656f32ff15e09d77c5d9eb8c4304e077777143ba6225dc8860405160405180910390a15b5b565b8060018190555050565b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505056fea26469706673582212209458b89f68ed66dc26086396962dad91224bfad1e1711e6151d84b91dfe798c564736f6c63430007030033
    gas 1000000
    build

transaction_build tx03
    sender acc1
    nonce 2
    receiverAddress 00
    value 0
    data 608060405234801561001057600080fd5b5061031d806100206000396000f3fe6080604052600436106100385760003560e01c806318d3af631461003b5780636efb15df14610045578063ba2647351461008057610039565b5b005b6100436100d1565b005b34801561005157600080fd5b5061007e6004803603602081101561006857600080fd5b810190808035906020019092919050505061029a565b005b34801561008c57600080fd5b506100cf600480360360208110156100a357600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506102a4565b005b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561012b57610298565b600060015411156101ea5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166318d3af636001546040518263ffffffff1660e01b81526004016000604051808303818588803b1580156101a057600080fd5b505af11580156101b4573d6000803e3d6000fd5b50505050507fd99f0cfde566379669cb08fdc25d80461af2e181833081dd90ca21eaabfc1f9560405160405180910390a1610297565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166318d3af636040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561025257600080fd5b505af1158015610266573d6000803e3d6000fd5b505050507fc912088d570658c8656f32ff15e09d77c5d9eb8c4304e077777143ba6225dc8860405160405180910390a15b5b565b8060018190555050565b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505056fea26469706673582212209458b89f68ed66dc26086396962dad91224bfad1e1711e6151d84b91dfe798c564736f6c63430007030033
    gas 1000000
    build

block_build b01
    parent g00
    transactions tx01 tx02 tx03
    build

block_connect b01
assert_best b01

# init next address 56aa252dd82173789984fa164ee26ce2da9336ff
transaction_build tx04
    sender acc1
    nonce 3
    receiverAddress 6252703f5ba322ec64d3ac45e56241b7d9e481ad
    data ba26473500000000000000000000000056aa252dd82173789984fa164ee26ce2da9336ff
    gas 1000000
    build

# init next address 27444fbce96cb2d27b94e116d1506d7739c05862
transaction_build tx05
    sender acc1
    nonce 4
    receiverAddress 56aa252dd82173789984fa164ee26ce2da9336ff
    data ba26473500000000000000000000000027444fbce96cb2d27b94e116d1506d7739c05862
    gas 1000000
    build

# set 1000 wei to send for second contract
transaction_build tx06
    sender acc1
    nonce 5
    receiverAddress 56aa252dd82173789984fa164ee26ce2da9336ff
    data 6efb15df00000000000000000000000000000000000000000000000000000000000003e8
    gas 1000000
    build

# deposit 1000 wei to second contract
transaction_build tx07
    sender acc1
    nonce 6
    receiverAddress 56aa252dd82173789984fa164ee26ce2da9336ff
    value 1000
    gas 1000000
    build

block_build b02
    parent b01
    transactions tx04 tx05 tx06 tx07
    build

block_connect b02
assert_best b02

